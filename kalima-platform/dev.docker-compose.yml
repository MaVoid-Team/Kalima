services:
  dev-frontend:
    build: 
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "8089:80"
      - "4449:443"
    environment:
      - VITE_API_URL=/api/v1
    volumes:
      - /etc/letsencrypt:/etc/letsencrypt:ro
    depends_on:
      - dev-backend
    networks:
      - dev-network

  dev-backend:
    build: 
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "5034:5000"
    environment:
      - NODE_ENV=development
      - DATABASE_URI=mongodb+srv://Kalima:6etSYaM16OA6zt@kalima.2cyib.mongodb.net/?retryWrites=true&w=majority&appName=Kalima
      - PORT=5000
      - REFRESH_TOKEN_SECRET=REFRESHSECRET44
      - ACCESS_TOKEN_SECRET=ACCESSSECRET44
      - CLOUDINARY_NAME=CLOUDINARYNAME
      - CLOUDINARY_KEY=CLOUDINARYKEY
      - CLOUDINARY_SECRET=CLOUDINARYSECRET
      - RESEND_API_KEY=RESENDAPIKEY
      - EMAIL_FROM=EMAILFROM@gmail.com
      - GOOGLE_CLIENT_EMAIL=CLIENTEMAIL
      - GOOGLE_PRIVATE_KEY=PRIVATEKEY
      - PAYMENT_SS_RETENTION_DAYS=30
    networks:
      - dev-network
    volumes:
      - uploads:/app/uploads

networks:
  dev-network:
    driver: bridge

volumes:
  uploads:
